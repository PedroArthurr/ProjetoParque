%YAML 1.1
%TAG !u! tag:unity3d.com,2011:
--- !u!1 &1166731288292957510
GameObject:
  m_ObjectHideFlags: 0
  m_CorrespondingSourceObject: {fileID: 0}
  m_PrefabInstance: {fileID: 0}
  m_PrefabAsset: {fileID: 0}
  serializedVersion: 6
  m_Component:
  - component: {fileID: 5506749581390134843}
  - component: {fileID: 6997486069317157577}
  - component: {fileID: 7575324482960827778}
  - component: {fileID: 4659727242451246443}
  m_Layer: 5
  m_Name: Button
  m_TagString: Untagged
  m_Icon: {fileID: 0}
  m_NavMeshLayer: 0
  m_StaticEditorFlags: 0
  m_IsActive: 1
--- !u!224 &5506749581390134843
RectTransform:
  m_ObjectHideFlags: 0
  m_CorrespondingSourceObject: {fileID: 0}
  m_PrefabInstance: {fileID: 0}
  m_PrefabAsset: {fileID: 0}
  m_GameObject: {fileID: 1166731288292957510}
  m_LocalRotation: {x: 0, y: 0, z: 0, w: 1}
  m_LocalPosition: {x: 0, y: 0, z: 0}
  m_LocalScale: {x: 1, y: 1, z: 1}
  m_ConstrainProportionsScale: 0
  m_Children:
  - {fileID: 4571241009352094458}
  m_Father: {fileID: 0}
  m_LocalEulerAnglesHint: {x: 0, y: 0, z: 0}
  m_AnchorMin: {x: 0, y: 0}
  m_AnchorMax: {x: 0, y: 0}
  m_AnchoredPosition: {x: 0, y: -21.94757}
  m_SizeDelta: {x: 160, y: 73.8953}
  m_Pivot: {x: 0.5, y: 0.5}
--- !u!222 &6997486069317157577
CanvasRenderer:
  m_ObjectHideFlags: 0
  m_CorrespondingSourceObject: {fileID: 0}
  m_PrefabInstance: {fileID: 0}
  m_PrefabAsset: {fileID: 0}
  m_GameObject: {fileID: 1166731288292957510}
  m_CullTransparentMesh: 1
--- !u!114 &7575324482960827778
MonoBehaviour:
  m_ObjectHideFlags: 0
  m_CorrespondingSourceObject: {fileID: 0}
  m_PrefabInstance: {fileID: 0}
  m_PrefabAsset: {fileID: 0}
  m_GameObject: {fileID: 1166731288292957510}
  m_Enabled: 1
  m_EditorHideFlags: 0
  m_Script: {fileID: 11500000, guid: fe87c0e1cc204ed48ad3b37840f39efc, type: 3}
  m_Name: 
  m_EditorClassIdentifier: 
  m_Material: {fileID: 0}
  m_Color: {r: 1, g: 1, b: 1, a: 1}
  m_RaycastTarget: 1
  m_RaycastPadding: {x: 0, y: 0, z: 0, w: 0}
  m_Maskable: 1
  m_OnCullStateChanged:
    m_PersistentCalls:
      m_Calls: []
  m_Sprite: {fileID: 10905, guid: 0000000000000000f000000000000000, type: 0}
  m_Type: 1
  m_PreserveAspect: 0
  m_FillCenter: 1
  m_FillMethod: 4
  m_FillAmount: 1
  m_FillClockwise: 1
  m_FillOrigin: 0
  m_UseSpriteMesh: 0
  m_PixelsPerUnitMultiplier: 1
--- !u!114 &4659727242451246443
MonoBehaviour:
  m_ObjectHideFlags: 0
  m_CorrespondingSourceObject: {fileID: 0}
  m_PrefabInstance: {fileID: 0}
  m_PrefabAsset: {fileID: 0}
  m_GameObject: {fileID: 1166731288292957510}
  m_Enabled: 1
  m_EditorHideFlags: 0
  m_Script: {fileID: 11500000, guid: 4e29b1a8efbd4b44bb3f3716e73f07ff, type: 3}
  m_Name: 
  m_EditorClassIdentifier: 
  m_Navigation:
    m_Mode: 3
    m_WrapAround: 0
    m_SelectOnUp: {fileID: 0}
    m_SelectOnDown: {fileID: 0}
    m_SelectOnLeft: {fileID: 0}
    m_SelectOnRight: {fileID: 0}
  m_Transition: 1
  m_Colors:
    m_NormalColor: {r: 1, g: 1, b: 1, a: 1}
    m_HighlightedColor: {r: 0.9607843, g: 0.9607843, b: 0.9607843, a: 1}
    m_PressedColor: {r: 0.78431374, g: 0.78431374, b: 0.78431374, a: 1}
    m_SelectedColor: {r: 0.9607843, g: 0.9607843, b: 0.9607843, a: 1}
    m_DisabledColor: {r: 0.78431374, g: 0.78431374, b: 0.78431374, a: 0.5019608}
    m_ColorMultiplier: 1
    m_FadeDuration: 0.1
  m_SpriteState:
    m_HighlightedSprite: {fileID: 0}
    m_PressedSprite: {fileID: 0}
    m_SelectedSprite: {fileID: 0}
    m_DisabledSprite: {fileID: 0}
  m_AnimationTriggers:
    m_NormalTrigger: Normal
    m_HighlightedTrigger: Highlighted
    m_PressedTrigger: Pressed
    m_SelectedTrigger: Selected
    m_DisabledTrigger: Disabled
  m_Interactable: 1
  m_TargetGraphic: {fileID: 7575324482960827778}
  m_OnClick:
    m_PersistentCalls:
      m_Calls: []
--- !u!1 &8242142217840811094
GameObject:
  m_ObjectHideFlags: 0
  m_CorrespondingSourceObject: {fileID: 0}
  m_PrefabInstance: {fileID: 0}
  m_PrefabAsset: {fileID: 0}
  serializedVersion: 6
  m_Component:
  - component: {fileID: 4571241009352094458}
  - component: {fileID: 9004972620753412422}
  - component: {fileID: 6707752825501836829}
  m_Layer: 5
  m_Name: Text (TMP)
  m_TagString: Untagged
  m_Icon: {fileID: 0}
  m_NavMeshLayer: 0
  m_StaticEditorFlags: 0
  m_IsActive: 1
--- !u!224 &4571241009352094458
RectTransform:
  m_ObjectHideFlags: 0
  m_CorrespondingSourceObject: {fileID: 0}
  m_PrefabInstance: {fileID: 0}
  m_PrefabAsset: {fileID: 0}
  m_GameObject: {fileID: 8242142217840811094}
  m_LocalRotation: {x: -0, y: -0, z: -0, w: 1}
  m_LocalPosition: {x: 0, y: 0, z: 0}
  m_LocalScale: {x: 1, y: 1, z: 1}
  m_ConstrainProportionsScale: 0
  m_Children: []
  m_Father: {fileID: 5506749581390134843}
  m_LocalEulerAnglesHint: {x: 0, y: 0, z: 0}
  m_AnchorMin: {x: 0, y: 0}
  m_AnchorMax: {x: 1, y: 1}
  m_AnchoredPosition: {x: 0, y: 0}
  m_SizeDelta: {x: 0, y: 0}
  m_Pivot: {x: 0.5, y: 0.5}
--- !u!222 &9004972620753412422
CanvasRenderer:
  m_ObjectHideFlags: 0
  m_CorrespondingSourceObject: {fileID: 0}
  m_PrefabInstance: {fileID: 0}
  m_PrefabAsset: {fileID: 0}
  m_GameObject: {fileID: 8242142217840811094}
  m_CullTransparentMesh: 1
--- !u!114 &6707752825501836829
MonoBehaviour:
  m_ObjectHideFlags: 0
  m_CorrespondingSourceObject: {fileID: 0}
  m_PrefabInstance: {fileID: 0}
  m_PrefabAsset: {fileID: 0}
  m_GameObject: {fileID: 8242142217840811094}
  m_Enabled: 1
  m_EditorHideFlags: 0
  m_Script: {fileID: 11500000, guid: f4688fdb7df04437aeb418b961361dc5, type: 3}
  m_Name: 
  m_EditorClassIdentifier: 
  m_Material: {fileID: 0}
  m_Color: {r: 1, g: 1, b: 1, a: 1}
  m_RaycastTarget: 1
  m_RaycastPadding: {x: 0, y: 0, z: 0, w: 0}
  m_Maskable: 1
  m_OnCullStateChanged:
    m_PersistentCalls:
      m_Calls: []
  m_text: "using UnityEngine;\nusing UnityEngine.UI;\nusing System.Collections.Generic;\nusing
    System.Text;\n\npublic class BuildMenuUI : MonoBehaviour\n{\n    [SerializeField]
    InventoryManager inventory;\n    [SerializeField] ConstructionManager construction;\n   
    [SerializeField] BuildRecipe[] recipes;\n    [SerializeField] Button buttonPrefab;\n   
    [SerializeField] Transform listRoot;\n    [SerializeField] GameObject panel;\n   
    [SerializeField] KeyCode toggleKey = KeyCode.B;\n\n    readonly List<Button>
    created = new List<Button>();\n    readonly Dictionary<Button, BuildRecipe> map
    = new Dictionary<Button, BuildRecipe>();\n\n    void Awake()\n    {\n       
    if (!inventory) inventory = InventoryManager.Instance;\n        if (!construction)
    construction = ConstructionManager.Instance;\n        if (panel) panel.SetActive(false);\n       
    Rebuild();\n    }\n\n    void OnEnable()\n    {\n        if (inventory != null)\n       
    {\n            inventory.OnItemCountChanged += OnInventoryChanged;\n           
    inventory.OnTotalChanged += _ => OnInventoryChanged(default, 0);\n        }\n   
    }\n\n    void OnDisable()\n    {\n        if (inventory != null)\n        {\n           
    inventory.OnItemCountChanged -= OnInventoryChanged;\n            inventory.OnTotalChanged
    -= _ => OnInventoryChanged(default, 0);\n        }\n    }\n\n    void Update()\n   
    {\n        if (panel && Input.GetKeyDown(toggleKey))\n        {\n           
    panel.SetActive(!panel.activeSelf);\n            if (panel.activeSelf) RefreshInteractable();\n       
    }\n    }\n\n    void OnInventoryChanged(ItemType _, int __) => RefreshInteractable();\n\n   
    void Rebuild()\n    {\n        ClearButtons();\n        if (!listRoot || !buttonPrefab
    || recipes == null) return;\n\n        for (int i = 0; i < recipes.Length; i++)\n       
    {\n            var r = recipes[i];\n            if (!r || !r.prefab) continue;\n\n           
    var btn = Instantiate(buttonPrefab, listRoot);\n            var txt = btn.GetComponentInChildren<Text>();\n           
    if (txt) txt.text = RecipeLabel(r);\n\n            btn.onClick.AddListener(()
    =>\n            {\n                if (CanAfford(r))\n                {\n                   
    construction.BeginBuild(r);\n                    if (panel) panel.SetActive(false);\n               
    }\n            });\n\n            created.Add(btn);\n            map[btn] = r;\n       
    }\n\n        RefreshInteractable();\n    }\n\n    void RefreshInteractable()\n   
    {\n        for (int i = 0; i < created.Count; i++)\n        {\n            var
    btn = created[i];\n            if (!btn || !map.ContainsKey(btn)) continue;\n           
    bool ok = CanAfford(map[btn]);\n            btn.gameObject.SetActive(ok);\n       
    }\n    }\n\n    bool CanAfford(BuildRecipe r)\n    {\n        if (!r || r.costs
    == null || inventory == null) return false;\n        for (int i = 0; i < r.costs.Length;
    i++)\n            if (inventory.GetCount(r.costs[i].type) < r.costs[i].amount)
    return false;\n        return true;\n    }\n\n    string RecipeLabel(BuildRecipe
    r)\n    {\n        var sb = new StringBuilder();\n        sb.Append(string.IsNullOrEmpty(r.id)
    ? r.name : r.id);\n        if (r.costs != null && r.costs.Length > 0)\n       
    {\n            sb.Append(\"  (\");\n            for (int i = 0; i < r.costs.Length;
    i++)\n            {\n                if (i > 0) sb.Append(\"  \");\n               
    sb.Append(r.costs[i].type).Append(\": \").Append(r.costs[i].amount);\n           
    }\n            sb.Append(\")\");\n        }\n        return sb.ToString();\n   
    }\n\n    void ClearButtons()\n    {\n        for (int i = 0; i < created.Count;
    i++)\n            if (created[i]) Destroy(created[i].gameObject);\n        created.Clear();\n       
    map.Clear();\n    }\n}\n"
  m_isRightToLeft: 0
  m_fontAsset: {fileID: 11400000, guid: 8f586378b4e144a9851e7b34d9b748ee, type: 2}
  m_sharedMaterial: {fileID: 2180264, guid: 8f586378b4e144a9851e7b34d9b748ee, type: 2}
  m_fontSharedMaterials: []
  m_fontMaterial: {fileID: 0}
  m_fontMaterials: []
  m_fontColor32:
    serializedVersion: 2
    rgba: 4281479730
  m_fontColor: {r: 0.19607843, g: 0.19607843, b: 0.19607843, a: 1}
  m_enableVertexGradient: 0
  m_colorMode: 3
  m_fontColorGradient:
    topLeft: {r: 1, g: 1, b: 1, a: 1}
    topRight: {r: 1, g: 1, b: 1, a: 1}
    bottomLeft: {r: 1, g: 1, b: 1, a: 1}
    bottomRight: {r: 1, g: 1, b: 1, a: 1}
  m_fontColorGradientPreset: {fileID: 0}
  m_spriteAsset: {fileID: 0}
  m_tintAllSprites: 0
  m_StyleSheet: {fileID: 0}
  m_TextStyleHashCode: -1183493901
  m_overrideHtmlColors: 0
  m_faceColor:
    serializedVersion: 2
    rgba: 4294967295
  m_fontSize: 24
  m_fontSizeBase: 24
  m_fontWeight: 400
  m_enableAutoSizing: 0
  m_fontSizeMin: 18
  m_fontSizeMax: 72
  m_fontStyle: 0
  m_HorizontalAlignment: 2
  m_VerticalAlignment: 512
  m_textAlignment: 65535
  m_characterSpacing: 0
  m_wordSpacing: 0
  m_lineSpacing: 0
  m_lineSpacingMax: 0
  m_paragraphSpacing: 0
  m_charWidthMaxAdj: 0
  m_TextWrappingMode: 1
  m_wordWrappingRatios: 0.4
  m_overflowMode: 0
  m_linkedTextComponent: {fileID: 0}
  parentLinkedComponent: {fileID: 0}
  m_enableKerning: 0
  m_ActiveFontFeatures: 6e72656b
  m_enableExtraPadding: 0
  checkPaddingRequired: 0
  m_isRichText: 1
  m_EmojiFallbackSupport: 1
  m_parseCtrlCharacters: 1
  m_isOrthographic: 1
  m_isCullingEnabled: 0
  m_horizontalMapping: 0
  m_verticalMapping: 0
  m_uvLineOffset: 0
  m_geometrySortingOrder: 0
  m_IsTextObjectScaleStatic: 0
  m_VertexBufferAutoSizeReduction: 0
  m_useMaxVisibleDescender: 1
  m_pageToDisplay: 1
  m_margin: {x: 0, y: 0, z: 0, w: 0}
  m_isUsingLegacyAnimationComponent: 0
  m_isVolumetricText: 0
  m_hasFontAssetChanged: 0
  m_baseMaterial: {fileID: 0}
  m_maskOffset: {x: 0, y: 0, z: 0, w: 0}
